<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->
<title>Koha -- Reports</title>

<!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="calendar.inc" -->
</head>
<body>
<!-- TMPL_INCLUDE NAME="header.inc" -->
<!-- TMPL_INCLUDE NAME="circ-search.inc" -->

<div id="breadcrumbs"><a href="/cgi-bin/koha/mainpage.pl">Home</a> &rsaquo; <a href="/cgi-bin/koha/circ/circulation.pl">Reports</a> &rsaquo; Guided Reports Wizard  &rsaquo; <strong> Dictionary </strong></div>

<div id="doc3" class="yui-t2">

<div id="bd">
<div id="yui-main">
<div class="yui-b">

<div class="details">
<h1>Dictionary</h1>
<!-- TMPL_IF NAME="start_dictionary" -->
<p>Use the dictionary to define custom criteria for reporting.</p>

<h2>Current Terms</h2>
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">
Filter By Area <select name="areas">
<option value="All">All</option>
<!-- TMPL_LOOP NAME="areas" -->     
<option value="<!-- TMPL_VAR NAME="id" -->"><!-- TMPL_VAR NAME="name"--></option>                  
<!-- /TMPL_LOOP -->                
</select> 
<input name="phase" value="Filter Dictionary" type="submit"> <input name="phase" value="Add New Definition" type="submit">
</form>
<br />
<table border="1" cellspacing="0" cellpadding="5">
<tr>
<th>Name</th>
<th>Description</th>
<th>Area</th>
<th>Definition</th>
</tr>
<!-- TMPL_LOOP NAME="definitions" -->
<tr valign="top">
<td><!-- TMPL_VAR NAME="name" --></td>
<td><!-- TMPL_VAR NAME="description" --></td>
<td><!-- TMPL_VAR NAME="area" --></td>
<td><!-- TMPL_VAR NAME="saved_sql" --></td>
<td><form method="post" action="/cgi-bin/koha/reports/dictionary.pl">
<input type="submit" name="phase" value="Delete Definition"><input type="hidden" name="id" value="<!-- TMPL_VAR NAME="id" -->">
</form></td>
</tr>
<!-- /TMPL_LOOP -->
</table>
<!-- /TMPL_IF -->


<!-- TMPL_IF NAME="new_dictionary" -->
<h1>Add New Definition</h1>
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">

<p><b>1 Name</b> | 2 Area | 3 Columns | 4 Values</p>
<table>
<tr>
<td>Definition Name:</td>
<td><input type="text" name="definition_name"></td>
</tr>
<td>Definition Description:</td>
<td><textarea name="definition_description"></textarea></td>

</tr>
</table>
																													  
<input type="hidden" name="phase" value="New Term step 2">
<input name="submit" value="Next" type="submit">
</form>
<!-- /TMPL_IF -->

<!-- TMPL_IF NAME="step_2" -->
<h1>Add New Definition</h1>

<p>1 Name | <b>2 Area</b> | 3 Columns | 4 Values</p>
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">
<input type="hidden" name="phase" value="New Term step 3">
<input type="hidden" name="definition_name" value="<!-- TMPL_VAR NAME="definition_name" -->">
<input type="hidden" name="definition_description" value="<!-- TMPL_VAR NAME="definition_description" -->">
Select table <select name="areas">
<!-- TMPL_LOOP NAME="areas" -->     
<option value="<!-- TMPL_VAR NAME="id" -->"><!-- TMPL_VAR NAME="name"--></option>                  
<!-- /TMPL_LOOP -->                
</select>
                                                                            
<input name="submit" value="Next" type="submit">
</form>
<!-- /TMPL_IF -->

<!-- TMPL_IF NAME="step_3" -->
<h1>Add New Definition</h1>

<p>1 Name | 2 Area | <b>3 Columns</b> | 4 Values</p>
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">      
<input type="hidden" name="area" value="<!-- TMPL_VAR NAME="area" -->">
<input type="hidden" name="definition_name" value="<!-- TMPL_VAR NAME="definition_name" -->">
<input type="hidden" name="definition_description" value="<!-- TMPL_VAR NAME="definition_description" -->">

<select id="availableColumns" name="oldcolumns2" multiple size="25" style="width:200px;height:300px;">    
<!-- TMPL_LOOP NAME="columns" -->                              
<!-- TMPL_IF NAME="table" -->                                                                                                      
<!-- TMPL_IF NAME="__first__" -->                              
<!-- TMPL_ELSE -->               
</optgroup>        
<!-- /TMPL_IF -->              
                                                                            

<optgroup label="<!-- TMPL_VAR NAME="table"-->">              
<!-- TMPL_ELSE -->               
<option value="<!-- TMPL_VAR NAME="name" -->">          
<!-- TMPL_IF NAME="description" --><!-- TMPL_VAR NAME="description" -->    
<!-- TMPL_ELSE -->               
<!-- TMPL_VAR NAME="name" -->                          
<!-- /TMPL_IF -->              
<!-- /TMPL_IF -->              
</option>      
<!-- /TMPL_LOOP -->                
</select>      
<input type="button" name="Add" value="Add" class="button" onClick="addColumn()"/>

<select id="selectedColumns" name="columns" multiple size="25" style="width:200px;height:300px;"></select>             
<input type="button" name="delete" value="delete" class="button" onClick="delColumn()"/>           
                                                                            
<input type="hidden" name="phase" value="New Term step 4">
<input type="submit" name="submit" value="Next">            
</form>    
<!-- /TMPL_IF -->

<!-- TMPL_IF NAME="step_4" -->
<h1>Add New Definition</h1>

<p>1 Name | 2 Area | 3 Columns | <b>4 Values</b></p>
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">
<input type="hidden" name="area" value="<!-- TMPL_VAR NAME="area" -->">
<input type="hidden" name="definition_name" value="<!-- TMPL_VAR NAME="definition_name" -->">
<input type="hidden" name="definition_description" value="<!-- TMPL_VAR NAME="definition_description" -->">
<input type="hidden" name="columnstring" value="<!-- TMPL_VAR NAME="columnstring" -->">

<!-- TMPL_LOOP NAME="columns" -->
<p>
<input type=hidden name="criteria_column" value="<!-- TMPL_VAR NAME="name" -->">
<!-- TMPL_VAR NAME="name" -->
<!-- TMPL_IF NAME="distinct" -->
<select name="<!-- TMPL_VAR NAME="name" -->_value">                    
<!-- TMPL_LOOP NAME="values" -->                             
<option value="<!-- TMPL_VAR NAME="availablevalues"-->"><!-- TMPL_VAR NAME="availablevalues" --></option>      
<!-- /TMPL_LOOP -->                
</select>  
<!-- /TMPL_IF -->
<!-- TMPL_IF NAME="date" -->
<table>
<tr valign="top">	   
<td><input type="radio" name="<!-- TMPL_VAR NAME="name" -->_all" value="all">All Dates</td>
<td>OR</td>
<td><input type="radio" name="dates" value="range">Date Range<br />
<table>
<tr>
<td>Start of Date Range</td>
<td><input type="text" size="10" id="<!-- TMPL_VAR NAME="name" -->_start_value" name="<!-- TMPL_VAR NAME="name" -->_start_value" value="" >      
<img src="<!-- TMPL_VAR Name="themelang" -->/lib/calendar/cal.gif" id="buttonfrom1" style="cursor: pointer;"  />    
<script type="text/javascript">                            
Calendar.setup({             
inputField     : "<!-- TMPL_VAR NAME="name" -->_start_value",    
ifFormat       : "%Y-%m-%d",                         
button         : "buttonfrom1",                            
align          : "Tl"                  
});
</script>
</td>
</tr>
<tr>
<td>End of Date Range</td>
<td>
<input type="text" size="10" id="<!-- TMPL_VAR NAME="name" -->_end_value" name="<!-- TMPL_VAR NAME="name" -->_end_value" value="" >      
<img src="<!-- TMPL_VAR Name="themelang" -->/lib/calendar/cal.gif" id="buttonfrom1" style="cursor: pointer;"  />    
<script type="text/javascript">                            
Calendar.setup({             
inputField     : "<!-- TMPL_VAR NAME="name" -->_end_value",    
ifFormat       : "%Y-%m-%d",                         
button         : "buttonfrom1",                            
align          : "Tl"                  
});
</script>
</td>
</tr>
</table></td>
</tr>
</table>
<!-- /TMPL_IF -->
<!-- TMPL_IF NAME="text">
<p>Search string matches <input type="text" size="13" name="<!-- TMPL_VAR NAME="name" -->_value"></p>
<!-- /TMPL_IF -->

</p>
<!-- /TMPL_LOOP -->
<input type="hidden" name="phase" value="New Term step 5">
<input type="submit" name="submit" value="Next">            
</form>
<!-- /TMPL_IF -->

<!-- TMPL_IF NAME="step_5" -->
<form action="/cgi-bin/koha/reports/dictionary.pl" method="post">      
<input type="hidden" name="area" value="<!-- TMPL_VAR NAME="area" -->">    
<input type="hidden" name="definition_name" value="<!-- TMPL_VAR NAME="definition_name" -->">           
<input type="hidden" name="definition_description" value="<!-- TMPL_VAR NAME="definition_description" -->">
<input type="hidden" name="columnstring" value="<!-- TMPL_VAR NAME="columnstring" -->">

<h3>Confirm Definition</h3>

<table>
<tr>
<td>Name:</td>
<td><!-- TMPL_VAR NAME="definition_name" --></td>
</tr>
<tr>
<td>Description:</td>
<td><!-- TMPL_VAR NAME="definition_description" --></td>
</tr>
<tr>
<td>Area:</td>
<td><!-- TMPL_VAR NAME="area" --></td>
</tr>
<tr>
<th>Columns</th>
<th>Values</th>
</tr>
<!-- TMPL_LOOP NAME="criteria_loop" -->
<tr>
<td><!-- TMPL_VAR NAME="name" --></td>
<td><!-- TMPL_VAR NAME="value" --></td>
</tr>
<!-- /TMPL_LOOP -->
</table>

<input type="hidden" name="sql" value="<!-- TMPL_VAR NAME="query" -->">
<input type="hidden" name="phase" value="New Term step 6">
<input type="submit" name="submit" value="Save">            

</form>
<!-- /TMPL_IF -->


</div>
</div>
</div>
<div class="yui-b">
<!-- TMPL_INCLUDE NAME="guided-reports-view.inc" -->
</div>
</div>
<script type="text/javascript">                            
function setObjects() {                    
    selectedColumnsObj=document.getElementById('selectedColumns');           
	availableColumnsObj=document.getElementById('availableColumns');   
}              
setObjects();                          

function addColumn() {                             
  for (i=0;i<availableColumnsObj.length;i++) {   
    if (availableColumnsObj.options[i].selected==true) {     
	  var newColumnObj=document.createElement("OPTION");                           
	  newColumnObj.value=availableColumnsObj.options[i].value;          
	  newColumnObj.text=availableColumnsObj.options[i].text;              
	  selectedColumnsObj.appendChild(newColumnObj);          
	  newColumnObj.selected=true;    
	}        
  }                        
}   

function delColumn() {                   
  for (i=0;i<=selectedColumnsObj.options.length;i++) {       
    if (selectedColumnsObj.options.selectedIndex>=0) {    
	  selectedColumnsObj.remove(selectedColumnsObj.options.selectedIndex)        
    }  
  }
}
</script>

<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->
