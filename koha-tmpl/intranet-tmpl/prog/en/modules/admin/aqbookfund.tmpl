<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->
<title>Koha &rsaquo; System Administration: Funds and Budgets</title>
<!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="menus.inc" -->
<!-- TMPL_INCLUDE NAME="menu-admin.inc" -->

<!-- TMPL_IF name="else" -->
<h1>Funds and budgets administration</h1>
  <!-- TMPL_IF NAME="bookfund" -->
<table>
  <tr>
    <th>Code</th>
    <th>Name</th>
    <th>Branch</th>
    <th>Actions</th>
  </tr>

<form action="<!-- TMPL_VAR name="scriptname" -->" method="post">
  <tr class="filter">
    <td>
      <select name="filter_bookfundid">
        <option value="">----</option>
    <!-- TMPL_LOOP name="filter_bookfundids" -->
      <!-- TMPL_IF NAME="selected" -->
        <option value="<!-- TMPL_VAR name="bookfundid" -->" selected="selected"><!-- TMPL_VAR name="bookfundid" --></option>
      <!-- TMPL_ELSE -->
        <option value="<!-- TMPL_VAR name="bookfundid" -->"><!-- TMPL_VAR name="bookfundid" --></option>
      <!-- /TMPL_IF -->
    <!-- /TMPL_LOOP -->
      </select>
    </td>
    <td>
      <input type="text" name="filter_bookfundname" value="<!-- TMPL_VAR name="filter_bookfundname" -->" />
    </td>
    <td>
      <select name="filter_branchcode">
        <option value="">----</option>
    <!-- TMPL_LOOP name="filter_branches" -->
      <!-- TMPL_IF NAME="selected" -->
        <option value="<!-- TMPL_VAR name="code" -->" selected="selected"><!-- TMPL_VAR name="name" --></option>
      <!-- TMPL_ELSE -->
        <option value="<!-- TMPL_VAR name="code" -->"><!-- TMPL_VAR name="name" --></option>
      <!-- /TMPL_IF -->
    <!-- /TMPL_LOOP -->
      </select>
    </td>
    <td>
      <input type="submit" name="filter" value="Filter" />
    </td>
  </tr>
</form>

<form action="aqbudget.pl" method="post">
    <!-- TMPL_LOOP name="bookfund" -->
      <!-- TMPL_IF NAME="toggle" -->
  <tr class="highlight">
      <!-- TMPL_ELSE -->
  <tr>
      <!-- /TMPL_IF -->
    <td>
      <!-- TMPL_VAR name="bookfundid" -->
    </td>
    <td>
      <!-- TMPL_VAR name="bookfundname" -->
    </td>
    <td>
      <!-- TMPL_IF NAME="branchname" -->
      <!-- TMPL_VAR name="branchname" -->
      <!-- TMPL_ELSE -->
      None
      <!-- /TMPL_IF -->
    </td>
    <td>
      <a href="<!-- TMPL_VAR name="scriptname" -->?op=add_form&amp;bookfundid=<!-- TMPL_VAR name="bookfundid" -->&amp;branchcode=<!-- TMPL_VAR name="branchcode" -->">Edit</a>
      <a href="<!-- TMPL_VAR name="scriptname" -->?op=delete_confirm&amp;bookfundid=<!-- TMPL_VAR name="bookfundid" -->&amp;branchcode=<!-- TMPL_VAR name="branchcode" -->">Delete</a>
      <a href="aqbudget.pl?op=add_form&amp;bookfundid=<!-- TMPL_VAR name="bookfundid" -->&amp;branchcode=<!-- TMPL_VAR name="branchcode" -->">Add budget</a>
      <!-- TMPL_IF NAME="has_budgets" -->
      <a href="aqbudget.pl?filter_bookfundid=<!-- TMPL_VAR name="bookfundid" -->">Show budgets</a>
      <!-- /TMPL_IF -->
    </td>
  </tr>

    <!-- /TMPL_LOOP --> <!-- bookfund -->
</table>

<div class="paginationBar"><!-- TMPL_VAR NAME="pagination_bar" --></div>
  <!-- /TMPL_IF --> <!-- bookfund -->

<p>
  <a href="<!-- TMPL_VAR name=scriptname -->?op=add_form">Add bookfund</a>
  <a href="aqbudget.pl">Show all budgets</a>
</p>

</form>
<!-- /TMPL_IF --> <!-- else -->

<!-- TMPL_IF name="add_form" -->
<script>
	//
	function isNotNull(f,noalert) {
		if (f.value.length ==0) {
   return false;
		}
		return true;
	}
	//
	function toUC(f) {
		var x=f.value.toUpperCase();
		f.value=x;
		return true;
	}
	//
	function isNum(v,maybenull) {
	var n = new Number(v.value);
	if (isNaN(n)) {
		return false;
		}
	if (maybenull==0 && v.value=="") {
		return false;
	}
	return true;
	}
	//
	function isDate(f) {
		var t = Date.parse(f.value);
		if (isNaN(t)) {
			return false;
		}
	}
	//
	function Check(f) {
		var ok=1;
		var _alertString="";
		var alertString2;
		if (f.bookfundid.value.length==0) {
			_alertString += "- bookfundid missing\n";
		}
		if (f.bookfundname.value.length==0) {
			_alertString += "- bookfundname missing\n";
		}
		if (_alertString.length==0) {
			document.Aform.submit();
		} else {
			alertString2 = "Form not submitted because of the following problem(s)\n";
			alertString2 += "------------------------------------------------------------------------------------\n\n";
			alertString2 += _alertString;
			alert(alertString2);
		}
	}
	</script>

<form action="<!-- TMPL_VAR name="action" -->" name="Aform" method="post">
  <input type="hidden" name="op" value="add_validate" />
  <input type="hidden" name="checked" value="0" />

  <table>
    <caption><!-- TMPL_VAR name="header" --></caption>
    
  <!-- TMPL_IF name="add_or_modify" -->
    <tr>
      <th>Book fund</th>
      <td>
        <input type="hidden" name="bookfundid" value="<!-- TMPL_VAR name="bookfundid" -->" />
        <!-- TMPL_VAR name="bookfundid" -->
      </td>
    </tr>
  <!-- TMPL_ELSE -->
    <tr>
      <th>Book fund</th>
      <td>
        <input type="text" name="bookfundid" size="5" maxlength="5" onblur="toUC(this)" />
      </td>
    </tr>
  <!-- /TMPL_IF --> <!-- add_or_modify -->
    
    <tr>
      <th>Name</th>
      <td>
        <input type="text"
               name="bookfundname"
               size="40"
          maxlength="80"
              value="<!-- TMPL_VAR name="bookfundname" escape="HTML" -->"
        />
      </td>
    </tr>

    <tr>
      <th>Branch</th>
      <td>
        <select name="branchcode">
          <option value="">None</option>
  <!-- TMPL_LOOP NAME="branches" -->
    <!-- TMPL_IF NAME="selected" -->
          <option value="<!-- TMPL_VAR NAME="branchcode" -->" selected="selected"><!-- TMPL_VAR NAME="branchname" --></option>
    <!-- TMPL_ELSE -->
          <option value="<!-- TMPL_VAR NAME="branchcode" -->"><!-- TMPL_VAR NAME="branchname" --></option>
    <!-- /TMPL_IF -->
  <!-- /TMPL_LOOP -->
      </td>
    </tr>
    
  </table>

  <p>
    <input type="button" value="Submit" onclick="Check(this.form); return false;" />
  </p>
</form>
<!-- /TMPL_IF --> <!-- add_form -->

<!-- TMPL_IF name="add_validate" -->
<h3>Data Recorded</h3>

<p>
  <a href="<!-- TMPL_VAR name="action" -->">Return to fund list</a>
</p>
<!-- /TMPL_IF -->

<!-- TMPL_IF name="delete_confirm" -->
<h3>Confirm Deletion of Fund <em><!-- TMPL_VAR name="bookfundid" --></em></h3>
<table>
  <tr>
    <th>Book fund</th>
    <td><!-- TMPL_VAR name="bookfundid" --></td>
  </tr>
  <tr>
    <th>Branch</th>
    <td><!-- TMPL_VAR name="branchcode" --></td>
  </tr>
  <tr>
    <th>Name</th>
    <td><!-- TMPL_VAR name="bookfundname" --></td>
  </tr>
  <tr>
    <th>Group</th>
    <td><!-- TMPL_VAR name="bookfundgroup" --></td>
  </tr>
</table>

<form action="<!-- TMPL_VAR name="action" -->" method="post">
  <input type="hidden" name="op" value="delete_confirmed" />
  <input type="hidden" name="bookfundid" value="<!-- TMPL_VAR name="bookfundid" -->" />
  <input type="hidden" name="branchcode" value="<!-- TMPL_VAR name="branchcode" -->" />

  <div id="action">
    <input type="submit" value="Delete this Fund" />
  </div>
</form>

<form action="<!-- TMPL_VAR name="action" -->" method="post">
  <input type="submit" value="Do not Delete" />
</form>
<!-- /TMPL_IF --> <!-- delete_confirm -->

<!-- TMPL_IF name="delete_confirmed" -->
<h3>Data Deleted</h3>
<form action="<!-- TMPL_VAR name="action" -->" method="post">
  <input type="submit" value="OK" />
</form>
<!-- /TMPL_IF --> <!-- delete_confirmed -->

<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->
