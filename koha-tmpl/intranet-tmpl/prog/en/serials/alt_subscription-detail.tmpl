<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->Koha -- Subscription edit<!--
TMPL_INCLUDE NAME="doc-head-close.inc" -->

<!-- TMPL_INCLUDE NAME="menus.inc" -->
<!--TMPL_INCLUDE NAME="menu-serials.inc" -->

<script type="text/javascript" language="javascript">
<!--
// the english words used in display purposes
var text = new Array('Number','Volume','Issue','Month','Week','Starting with:','Rollover at:','Choose Hemisphere:','Northern','Southern',
'Autumn','Winter','Spring','Summer','Fall','Season','Year');

// common pre defined number patterns
function num_pattern() {
var patternchoice = '<!--TMPL_VAR NAME='numberpattern'-->';
	switch(patternchoice){
	case "2":
		options(text[1],text[0],text[2]);
		irregularity();
		display_table(0);
		break;
	case "3":
		options(text[1],text[0]);
		irregularity();
		display_table(0);
		break;
	case "4":
		options(text[1],text[2]);
		irregularity();
		display_table(0);
		break;
	case "5":
		options(text[0],text[2]);
		irregularity();
		display_table(0);
		break;
	case "6":
		var d = new Date();
		var sYear = d.getFullYear();
		// options_seasons(text[15],sYear);
		irregularity();
		is_season = 1;
		display_table(0);
		break;
	case "7":
		display_table(1);
		irregularity();
		break;
	default:
		options(text[0]);
		irregularity();
		display_table(0);
		break;
	}
}

function display_table(n) {
	if(n==1){
		document.getElementById("basetable").style.display = 'block';
	} else {
		document.getElementById("basetable").style.display = 'none';
	}
}

// to dispaly the options section
function options(x,y,z){
var textbox = '';
	// alert("X: "+x+"Y: "+y+"Z: "+z);
	if(x){
		document.f.xfield.value = x;
		if(y){
			document.f.yfield.value = y;
			if(z){
				document.f.zfield.value = z;
			}
		}
	}
}

function irregularity(){
	var periodicity = '<!-- TMPL_VAR NAME="periodicity"-->';
	switch(periodicity){
	case "1":
		var names = new Array('Monday','Tuesday','Wednesday','Thursday','Friday','Saturday','Sunday');
		break;
	case "2":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "3":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "4":
		<!-- TMPL_IF NAME="weekarrayjs" -->
		var names = new Array(<!-- TMPL_VAR NAME="weekarrayjs" -->); 
		<!-- /TMPL_IF -->
		break;
	case "5":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "6":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "7":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "8":
		var names = new Array('Autumn','Winter','Spring','Summer','Fall');
		break;
	case "9":
		var names = new Array('January','February','March','April','May','June','July','August','September','October','November','December');
		break;
	case "10":
		expected =1;
		break;
	default:
		break;
	}

	<!-- TMPL_IF NAME="irregularity" -->
	var irregular = '<!-- TMPL_VAR NAME="irregularity" -->';
	var irregarray = irregular.split('|');
	var irregtext = '<p>';
	for(var i=0;i<irregarray.length;i++){
		irregtext += names[i]+' &nbsp;';
	}
	irregtext += '</p>';
	document.getElementById("irreg").innerHTML = irregtext;
	<!-- /TMPL_IF -->
}

-->
</script>
<div id="mainbloc">
<h1>Subscription</h1>
<a href="alt_subscription-add.pl?op=mod&amp;subscriptionid=<!-- TMPL_VAR name="subscriptionid" -->" class="button">Edit</a>
<a href="statecollection.pl?subscriptionid=<!-- TMPL_VAR name="subscriptionid" -->" class="button">Receive</a>
<!--<a href="/cgi-bin/koha/MARCdetail.pl?bib=<!-- TMPL_VAR name="biblionumber" -->" class="button">Biblio</a>-->
<a href="/cgi-bin/koha/detail.pl?bib=<!-- TMPL_VAR name="biblionumber" -->" class="button">Biblio</a>
<!-- TMPL_IF NAME="routing" -->
<a href="/cgi-bin/koha/serials/routing.pl?subscriptionid=<!-- TMPL_VAR NAME="subscriptionid" -->" class="button">Edit Routing List</a>
<!-- TMPL_ELSE -->
<a href="/cgi-bin/koha/serials/routing.pl?subscriptionid=<!-- TMPL_VAR NAME="subscriptionid" -->&op=new" class="button">Create Routing List</a>
<!-- /TMPL_IF -->
<a href="subscription-copy.pl?subscriptionid=<!-- TMPL_VAR name="subscriptionid" -->" class="button">Copy</a>


<!-- TMPL_UNLESS name="totalissues" -->
		<a href="javascript:confirm_deletion()" class="button">
			delete
		</a>
<!-- /TMPL_UNLESS -->

<table>
<tr valign="top"><td>

<div class="bloc25">
	<h2>Subscription information</h2>
	<p><label class="label100">Librarian identity:</label> <!-- TMPL_VAR name="librarian" --></p><br />

	<p><label class="label100">Supplier:</label> <!-- TMPL_VAR name="aqbooksellername" -->&nbsp;</p>

	<p><label class="label100">Cost:</label> <!-- TMPL_VAR name="cost" -->&nbsp;</p>

	<p><label class="label100">Budget:</label> <!-- TMPL_VAR name="bookfundid" -->&nbsp;</p>

	<p><label class="label100">Biblio:</label> <i>(<!-- TMPL_VAR name="biblionumber" -->)</i> <!-- TMPL_VAR name="bibliotitle" --></p><br />
	<p><label class="label100">Call Number:</label> <!-- TMPL_VAR name="callnumber" -->&nbsp;</p>

	<p><label class="label100">Notes:</label> <!-- TMPL_VAR name="notes" --></p>
</div>

<div class="bloc25">
	<form name="f">
	<h2>Planning</h2>
	<p><label class="label100">Beginnning date:</label> <!-- TMPL_VAR name="startdate" -->
	</p>
	<p><label class="label100">Frequency (*):</label>
		<!--TMPL_IF name="periodicity1" -->
				1/day
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity2" -->
				1/week
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity3" -->
				1/2 weeks
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity4" -->
				1/3 weeks
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity5" -->
				1/Month
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity6" -->
				1/2 Months (6/year)
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity7" -->
				1/quarter
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity8" -->
				1/quarter
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity9" -->
				2/year
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity10" -->
				1/year
		<!-- /TMPL_IF -->
		<!--TMPL_IF name="periodicity11" -->
				1/2 years
		<!-- /TMPL_IF -->
	</p>
	<p><label class="label100">Number Pattern:</label>
		<!-- TMPL_IF name="numberpattern1" -->
			Number
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern2" -->
			Volume, Number, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern3" -->
			Volume, Number
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern4" -->
			Volume, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern5" -->
			Number, Issue
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern6" -->
			Seasonal only
		<!-- /TMPL_IF -->
		<!-- TMPL_IF name="numberpattern7" -->
			None of the above
		<!-- /TMPL_IF -->
	</p>
	<table cellpadding="0" cellspacing="0">
	<tr><td>&nbsp;</td>
	    <td align="right"><input type="text" name="xfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
	<!--TMPL_IF NAME="lastvalue2"-->
	    <td align="right"><input type="text" name="yfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
	<!--/TMPL_IF-->
	<!--TMPL_IF NAME="lastvalue3"-->
	    <td align="right"><input type="text" name="zfield" style="border:0px solid #FFFFFF; text-align:center;"></td>
	<!--/TMPL_IF-->
	</tr>
	<tr><td><p><label class="label100">Starting with:</label></p></td>
	    <td align="center"><!--TMPL_VAR NAME="lastvalue1"--></td>
	<!--TMPL_IF NAME="lastvalue2"-->
	    <td align="center">&nbsp; 
			<!--TMPL_VAR NAME="lastvalue2"-->
	    </td>
	<!--/TMPL_IF-->
	<!--TMPL_IF NAME="lastvalue3"-->
	    <td align="center">&nbsp; 
			<!--TMPL_VAR NAME="lastvalue3"-->
	    </td>
	<!--/TMPL_IF-->
	</tr>
	<tr><td><p><label class="label100">Rollover:</label></p></td>
	    <td align="center">&nbsp;</td>
	<!--TMPL_IF NAME="whenmorethan2"-->
	    <td align="center">&nbsp; 
			<!--TMPL_VAR NAME="whenmorethan2"-->
	    </td>
	<!--/TMPL_IF-->
	<!--TMPL_IF NAME="whenmorethan3"-->
	    <td align="center">&nbsp; 
			<!--TMPL_VAR NAME="whenmorethan3"-->
	    </td>
	<!--/TMPL_IF-->
	</tr>
	</table>
	<!-- TMPL_IF NAME="irregularity" -->
	<p><label class="label100">Irregularity:</label>
		<div id="irreg"></div>
	</p>
	<!-- /TMPL_IF -->
	<p><label class="label100">Begins on:</label>
		<!--TMPL_VAR name="startdate" -->
	</p>
	</form>
</div>
<div class="bloc25">
	<h2>Subscription length</h2>
	<!-- TMPL_IF name="numberlength" --><p><label>Number of issues:</label> <!-- TMPL_VAR name="numberlength" --></p><!-- /TMPL_IF -->
	<!-- TMPL_IF name="weeklength" --><p><label>Number of weeks:</label> <!-- TMPL_VAR name="weeklength" --></p><!-- /TMPL_IF -->
	<!-- TMPL_IF name="monthlength" --><p><label class="label100">Number of months:</label> <!-- TMPL_VAR name="monthlength" --></p><!-- /TMPL_IF -->

</div>
<div class="bloc25">
	<h2>Numbering calculation</h2>
	<p><label class="label100">Numbering formula:</label> <!-- TMPL_VAR name="numberingmethod" --></p>
</div>
<div class="bloc25" id="basetable">
	<table cellpadding="0" cellspacing="0" border="0" class="collapse">
		<tr>
			<th class="cell-header">&nbsp;</th>
			<th class="cell-header">X</th>
			<th class="cell-header">Y</th>
			<th class="cell-header">Z</th>
			</tr>
			<tr>
				<td class="cell">Add</td>
				<td class="cell">
					<!-- TMPL_VAR name="add1" -->
				</td>
				<td class="cell">
					<!-- TMPL_VAR name="add2" -->
				</td>
				<td class="cell">
					<!-- TMPL_VAR name="add3" -->
				</td>
			</tr>
			<tr>
				<td class="cell">once every</td>
				<td class="cell"><!-- TMPL_VAR name="every1" --></td>
				<td class="cell"><!-- TMPL_VAR name="every2" --></td>
				<td class="cell"><!-- TMPL_VAR name="every3" --></td>
			</tr>
			<tr>
				<td class="cell">When more than</td>
				<td class="cell"><!-- TMPL_VAR name="whenmorethan1" --> <!-- TMPL_IF name="innerloop1" --><br/>
					<i>(is <!-- TMPL_VAR name="innerloop1" -->)</i><!-- /TMPL_IF --></td>
				<td class="cell"><!-- TMPL_VAR name="whenmorethan2" --> <!-- TMPL_IF name="innerloop2" --><br/>
					<i>(is <!-- TMPL_VAR name="innerloop2" -->)</i><!-- /TMPL_IF --></td>
				<td class="cell"><!-- TMPL_VAR name="whenmorethan3" --> <!-- TMPL_IF name="innerloop3" --><br/>
					<i>(is <!-- TMPL_VAR name="innerloop3" -->)</i><!-- /TMPL_IF --></td>
			</tr>
			<tr>
				<td class="cell">Set back to</td>
				<td class="cell"><!-- TMPL_VAR name="setto1" --></td>
				<td class="cell"><!-- TMPL_VAR name="setto2" --></td>
				<td class="cell"><!-- TMPL_VAR name="setto3" --></td>
			</tr>
			<tr>
				<td class="cell">
						Last value
				</td>
				<td class="cell"><!-- TMPL_VAR name="lastvalue1" --></td>
				<td class="cell"><!-- TMPL_VAR name="lastvalue2" --></td>
				<td class="cell"><!-- TMPL_VAR name="lastvalue3" --></td>
			</tr>
		</table>
</div>
</td><td>
<div class="bloc25">
	<h2>Issues</h2>
	<table cellpadding="0" cellspacing="0" border="0" class="collapse">
	<tr>
		<th class="cell-header">Issue number</th>
		<th class="cell-header">Planned date</th>
		<th class="cell-header">Status</th>
	</tr>
	<!-- TMPL_LOOP name="serialslist" -->
		<tr>
			<td class="cell">
				<!-- TMPL_VAR name="serialseq" -->
			</td>
			<td class="cell">
				<!-- TMPL_VAR name="planneddate" -->
			</td>
			<td class="cell">
					<!--TMPL_IF name="status1" -->
						Waited
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status2" -->
						Arrived
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status3" -->
						Late
					<!-- /TMPL_IF -->
					<!--TMPL_IF name="status4" -->
						Missing
					<!-- /TMPL_IF -->
			</td>
		</tr>
	<!-- /TMPL_LOOP -->
	</table>
</div>
</td></tr>
</table>

</div>
<script type="text/javascript">
function _(s) { return s } // dummy function for gettext
function confirm_deletion() {
	var is_confirmed = confirm(_('Are you sure you want to delete this subscription?'));
	if (is_confirmed) {
		window.location="alt_subscription-detail.pl?subscriptionid=<!-- TMPL_VAR name="subscriptionid" -->&op=del";
	}
}
window.onload = num_pattern();
</script>
<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->
