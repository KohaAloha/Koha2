<!-- TMPL_INCLUDE NAME="parameters-top.inc" -->

<script>
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function isNotNull(f,noalert) {
	if (f.value.length ==0) {
		return false;
	}
	return true;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function toUC(f) {
	var x=f.value.toUpperCase();
	f.value=x;
	return true;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function isNum(v,maybenull) {
var n = new Number(v.value);
if (isNaN(n)) {
	return false;
	}
if (maybenull==0 && v.value=='') {
	return false;
}
return true;
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function isDate(f) {
	var t = Date.parse(f.value);
	if (isNaN(t)) {
		return false;
	}
}
/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
function Check(f) {
	var ok=1;
	var _alertString="";
	var alertString2;
	if (f.itemtype.value.length==0) {
		_alertString += "- Itemtype missing\n";
	}
	if (!(isNotNull(window.document.Aform.description,1))) {
		_alertString += "- Description missing\n";
	}
	if ((!isNum(f.loanlength,0)) && f.loanlength.value.length > 0) {
		_alertString += "- Loan length is not a number\n";
	}
	if ((!isNum(f.rentalcharge,0)) && f.rentalcharge.value.length > 0) {
		_alertString += "- Rental charge is not a number\n";
	}
	if (_alertString.length==0) {
		document.Aform.submit();
	} else {
		alertString2 = "Form not submitted because of the following problem(s)\n";
		alertString2 += "------------------------------------------------------------------------------------\n\n";
		alertString2 += _alertString;
		alert(alertString2);
	}
}
</SCRIPT>
<!-- TMPL_IF name="add_form" -->
	<!-- TMPL_IF name="itemtype" -->
		<h1>修改館藏類別</h1>
	<!-- TMPL_ELSE -->
		<h1>新增館藏類別</h1>
	<!-- /TMPL_IF -->
	<form action='<!-- TMPL_VAR name="script_name" -->' name=Aform method=post>
		<input type=hidden name=op value='add_validate'>
		<input type=hidden name=checked value=0>
		<table>
			<!-- TMPL_IF name="itemtype" -->
				<tr><td>館藏類別</td><td><input type=hidden name=itemtype value=<!-- TMPL_VAR name="itemtype" -->><!-- TMPL_VAR name="itemtype" --></td></tr>
			<!-- TMPL_ELSE -->
				<tr><td>館藏類別</td><td><input type=text name=itemtype size=6 maxlength=4 onBlur="toUC(this)"></td></tr>
			<!-- /TMPL_IF -->
			<tr>
				<td>說明</td>
				<td><input type=text name=description size=40 maxlength=80 value='<!-- TMPL_VAR name="description" escape=HTML -->'>&nbsp;</td>
			</tr>
			<tr>
				<td>可借多久 (以日計)</td>
				<td><input type=text name=loanlength size=10 value='<!-- TMPL_VAR name="loanlength" -->'></td>
			</tr>
			<tr>
				<td>可否續借</td>
				<td><input type=checkbox name=renewalsallowed <!-- TMPL_IF name="renewalsallowed" -->checked<!-- /TMPL_IF --> value=1></td>
			</tr>
			<tr>
				<td>借閱費用</td>
				<td><input type=text name=rentalcharge size=10 value='<!-- TMPL_VAR name="rentalcharge" -->'></td>
			</tr>
			<tr>
				<td>&nbsp;</td>
				<td><INPUT type=button value='好' onClick='Check(this.form)'></td>
			</tr>
		</table>
	</form>
<!-- /TMPL_IF -->

<!-- TMPL_IF name="delete_confirm" -->
	<TABLE bg="#99cc33">
		<tr>
			<th>館藏類別</th>
			<th><!-- TMPL_VAR name="itemtype" --></th>
		</tr>
	<form action='<!-- TMPL_VAR name="script_name" -->' method=post>
		<input type=hidden name=op value=delete_confirmed><input type=hidden name=itemtype value='<!-- TMPL_VAR name="itemtype" -->'>
	<tr><td>說明</td><td><!-- TMPL_VAR name="description" --></td></tr>
	<tr><td>可借多久</td><td><TMPL_IF name="loanlength"><span class=en><!-- TMPL_VAR name="loanlength" --></span>日<TMPL_ELSE>不可借出</TMPL_IF></td></tr>
	<tr><td>可否續借</td><td><!-- TMPL_IF name="renewalsallowed" -->可以續借<!-- TMPL_ELSE -->不可續借<!-- /TMPL_IF --></td></tr>
	<tr><td>借閱費用</td><td><!-- TMPL_VAR name="rentalcharge" --></td></tr>
	<!-- TMPL_IF name="total" -->
		<tr><td colspan=2 align=center><b>這個記錄被用<!-- TMPL_VAR name="total" -->次，不能移除。</b></td></tr>
		<tr><td colspan=2></form><form action='<!-- TMPL_VAR name="script_name" -->' method=post><input type=submit value="好"></form></td></tr>
	<!-- TMPL_ELSE -->
		<tr><td colspan=2 align=center>確定要移除嗎？</td></tr>
		<tr><td><INPUT type=submit value='移除'></form></td><td><form action='<!-- TMPL_VAR name="script_name" -->' method=post><input type=submit value='取消'></form></td></tr>
	<!-- /TMPL_IF -->

	</table>
<!-- /TMPL_IF -->

<!-- TMPL_IF name="else" -->
<h1>設定館藏類別</h1>
<table border='1' cellpadding='5' cellspacing='0' width='550'>
	<tr>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif"><b>編碼</b></th>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif"><b>說明</b></td>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif"><b>可借多久</b></td>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif"><b>可否續借</b></td>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif"><b>借閱費用</b></td>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif">修改</td>
		<td background="<!-- TMPL_VAR NAME='themelang' -->/images/background-mem.gif">移除</td>
	</tr>
	<!-- TMPL_LOOP name="loop" -->
		<tr>
			<td><!-- TMPL_VAR name="itemtype" --></td>
			<td><!-- TMPL_VAR name="description" --></td>
			<td><span class=en><!-- TMPL_VAR name="loanlength" --></span></td>
			<td><!-- TMPL_IF name="renewalsallowed" -->可以續借<!-- TMPL_ELSE -->不可續借<!-- /TMPL_IF --></td>
			<td><span class=en><!-- TMPL_VAR name="rentalcharge" --></span></td>
			<td><a href="<!-- TMPL_VAR name="script_name" -->?op=add_form&itemtype=<!-- TMPL_VAR name="itemtype" escape="HTML" -->"><img src="<!-- TMPL_VAR NAME='interface' -->/<!-- TMPL_VAR name="theme" -->/images/fileopen.png"  width=32 hspace=0 vspace=0 border=0></a></td>
			<td><a href="<!-- TMPL_VAR name="script_name" -->?op=delete_confirm&itemtype=<!-- TMPL_VAR name="itemtype" escape="HTML" -->"><img src="<!-- TMPL_VAR NAME='interface' -->/<!-- TMPL_VAR name="theme" -->/images/edittrash.png" width=32 hspace=0 vspace=0 border=0></a></td>
		</tr>
	<!-- /TMPL_LOOP -->
</table>
<form action='<!-- TMPL_VAR name="script_name" -->' method=post>
<input type=hidden name=op value=add_form>
<br>
<table width=40%>
	<tr>
		<td width="33%">
			<input type=submit class="button" value="新增館藏類別" title="新增館藏類別" alt="新增館藏類別" >
		</td>
		<td width="33%"><!-- TMPL_IF name="previous" --><a href="<!-- TMPL_VAR name=previous -->"><input type=image src="<!-- TMPL_VAR name="interface" -->/<!-- TMPL_VAR name="theme" -->/images/1leftarrow.png" title="上一頁" ALT="上一頁" BORDER=0></a><!-- /TMPL_IF --></td>
		<td width="33%"><!-- TMPL_IF name="next" --><a href="<!-- TMPL_VAR name=next -->"><input type=image src="<!-- TMPL_VAR name="interface" -->/<!-- TMPL_VAR name="theme" -->/images/1rightarrow.png" title="下一頁" ALT="下一頁" BORDER=0></a><!-- /TMPL_IF --></td>
	</tr>
</table>
</form>
<!-- /TMPL_IF -->
<!-- TMPL_INCLUDE NAME="parameters-bottom.inc" -->
