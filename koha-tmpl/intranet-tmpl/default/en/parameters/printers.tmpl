<TMPL_INCLUDE NAME="parameters-top.inc">

<TMPL_IF NAME=add_form>
        <script>
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        function isNotNull(f,noalert) {
                if (f.value.length ==0) {
   return false;
                }
                return true;
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        function toUC(f) {
                var x=f.value.toUpperCase();
                f.value=x;
                return true;
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        function isNum(v,maybenull) {
        var n = new Number(v.value);
        if (isNaN(n)) {
                return false;
                }
        if (maybenull==0 && v.value=='') {
                return false;
        }
        return true;
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        function isDate(f) {
                var t = Date.parse(f.value);
                if (isNaN(t)) {
                        return false;
                }
        }
        /////////////////////////////////////////////////////////////////////////////////////////////////////////////////
        function Check(f) {
                var ok=1;
                var _alertString="";
                var alertString2;
                if (f.printername.value.length==0) {
                        _alertString += "- printer name missing\\n";
                }
                if (f.printqueue.value.length==0) {
                        _alertString += "- Queue missing\\n";
                }
                if (_alertString.length==0) {
                        document.Aform.submit();
                } else {
                        alertString2 = "Form not submitted because of the following problem(s)\\n";
                        alertString2 += "------------------------------------------------------------------------------------\\n\\n";
                        alertString2 += _alertString;
                        alert(alertString2);
                }
        }
        </SCRIPT>

	<TMPL_IF NAME=searchfield>
		<h1>Modify printer</h1>
	<TMPL_ELSE>
		<h1>Add printer</h1>
	</TMPL_IF>

        <form action='<TMPL_VAR NAME=script_name>' name=Aform method=post>
        <input type=hidden name=op value='add_validate'>
        

	<table>

	<TMPL_IF NAME=searchfield>
		<tr>
			<td>Printer Name</td>
			<td>
				<input type=hidden name=printername value='<TMPL_VAR NAME=searchfield>'><TMPL_VAR NAME=searchfield>
			</td>
		</tr>
	<TMPL_ELSE>
		<tr>
			<td>Printer Name</td>
			<td>
				<input type=text name=printername size=50 maxlength=50>
			</td>
		</tr>
	</TMPL_IF>

        	<tr>
			<td>Queue</td>
			<td><input type=text name=printqueue size=50 maxlength=50 value='<TMPL_VAR NAME=printqueue>'> </td>
		</tr>
        	<tr>
			<td>Type</td>
			<td><input type=text name=printtype size=50 maxlength=50 value='<TMPL_VAR NAME=printtype>'> </td>
		</tr>
        	<tr>
			<td> </td>
			<td><INPUT type=button value='OK' onClick='Check(this.form)'></td>
		</tr>
        </table>
        </form>

</TMPL_IF>

<TMPL_IF NAME=add_validate>
	data recorded
        <form action='<TMPL_VAR NAME=script_name>' method=post>
        <input type=submit value=OK>
        </form>
</TMPL_IF>

<TMPL_IF NAME=delete_confirm>
	<table border=0 cellspacing=0 cellpadding=5>
		<tr bgcolor='#99cc33'>
			<td background='/images/background-mem.gif'><b>Printer</b></td>
			<td background='/images/background-mem.gif'><b><TMPL_VAR NAME=searchfield></b></td>
		</tr>

        	<form action='<TMPL_VAR NAME=script_name>' method=post>
			<input type=hidden name=op value=delete_confirmed>
			<input type=hidden name=searchfield value='<TMPL_VAR NAME=searchfield>'>
        
		<tr>
			<td>Queue</td>
			<td><TMPL_VAR NAME=printqueue></td>
		</tr>
        	<tr>
			<td>Type</td>
			<td><TMPL_VAR NAME=printtype></td>
		</tr>
        	<tr>
			<td colspan=2 align=center>CONFIRM DELETION</td>
		</tr>
        	<tr>
			<td>
				<input type=submit value=YES>
				</form>
			</td>
			<td>
				<form action='<TMPL_VAR NAME=script_name>' method=post>
				<input type=submit value=NO>
				</form>
			</td>
		</tr>
	</table>
</TMPL_IF>

<TMPL_IF NAME=delete_confirmed>
	data deleted
	<form action='<TMPL_VAR NAME=script_name>' method=post>
		<input type=submit value=OK>
	</form>
</TMPL_IF>

<TMPL_IF NAME=else>
	<h2>Printer admin</h2>
        <form action='<TMP_VAR NAME=script_name>' method=post>
                <input type=text name=description value=<TMPL_VAR NAME=searchfield>>
                <input type=reset name=reset value="clr">
        </form>

	<TMPL_IF NAME=searchfield>
		You searched for <b><TMPL_VAR NAME=searchfield></b>
	</TMPL_IF>

	<table border=0 cellspacing=0 cellpadding=5>
		<tr bgcolor='#99cc33'>
			<td background='/images/background-mem.gif'><b>Name</b></td>
			<td background='/images/background-mem.gif'><b>Queue</b></td>
			<td background='/images/background-mem.gif'><b>Type</b></td>
			<td background='/images/background-mem.gif'> </td>
			<td background='/images/background-mem.gif'> </td>
		</tr>
		<TMPL_LOOP NAME=loop>
		<tr bgcolor="<TMPL_VAR NAME=toggle>">
			<td><TMPL_VAR NAME=printername></td>
			<td><TMPL_VAR NAME=printqueue></td>
			<td><TMPL_VAR NAME=printtype></td>
			<td><a href="<TMPL_VAR NAME=script_name>?op=add_form&searchfield=<TMPL_VAR NAME=printername>">Edit</a></td>
                        <td><a href="<TMPL_VAR NAME=script_name>?op=delete_confirm&searchfield=<TMPL_VAR NAME=printername>">Delete</a></td>
		</tr>
		</TMPL_LOOP>
	</table>

	<form action='<TMPL_VAR NAME=script_name>' method=post>
        <input type=hidden name=op value=add_form>
	
	<TMPL_IF NAME=offsetgtzero>
		<a href="<TMPL_VAR NAME=script_name>?offset=<TMPL_VAR NAME=prevpage>"><< Prev</a>
	</TMPL_IF>

	&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

	<TMPL_IF NAME=ltcount>
		<a href="<TMPL_VAR NAME=script_name>?offset=<TMPL_VAR NAME=nextpage>">Next >></a>	
	</TMPL_iF>

        <br>
	<input type=image src="/images/button-add-new.gif" WIDTH=188 HEIGHT=44 ALT="Add printers" title="Add" BORDER=0 ></a>
	<br>
        </form>

</TMPL_IF>


<TMPL_INCLUDE NAME="parameters-bottom.inc">
