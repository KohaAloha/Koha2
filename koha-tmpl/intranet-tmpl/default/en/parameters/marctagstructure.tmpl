<!-- TMPL_INCLUDE NAME="parameters-top.inc" -->

<div id="mainbloc">
<h1 class="parameters">MARC tag structure admin for <!-- TMPL_IF NAME="frameworkcode" --><!-- TMPL_VAR NAME="frameworktext" --> (<!-- TMPL_VAR NAME="frameworkcode" -->)<!-- TMPL_ELSE -->default MARC framework<!-- /TMPL_IF --></h1>
<script language="javascript" type="text/javascript">
	function _(s) { return s } // dummy function for gettext
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	function isNotNull(f,noalert) {
		if (f.value.length ==0) {
   return false;
		}
		return true;
	}
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	function toUC(f) {
		var x=f.value.toUpperCase();
		f.value=x;
		return true;
	}
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	function isNum(v,maybenull) {
	var n = new Number(v.value);
	if (isNaN(n)) {
		return false;
		}
	if (maybenull==0 && v.value=='') {
		return false;
	}
	return true;
	}
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	function isDate(f) {
		var t = Date.parse(f.value);
		if (isNaN(t)) {
			return false;
		}
	}
	/////////////////////////////////////////////////////////////////////////////////////////////////////////////////
	function Check(f) {
		var ok=1;
		var _alertString="";
		var alertString2;
		if (f.tagfield.value.length==0) {
			_alertString += "\n- " + _("tag number missing");
		}
		if (_alertString.length==0) {
			document.Aform.submit();
		} else {
			alertString2  = _("Form not submitted because of the following problem(s)");
			alertString2 += "\n------------------------------------------------------------------------------------\n";
			alertString2 += _alertString;
			alert(alertString2);
		}
	}
	</script>

<!-- TMPL_IF NAME="add_form" -->
<!-- ------------------------------------------------------------------------ -->
	<h1 class="parameters">
	<!-- TMPL_IF NAME="use-heading-flags-p" -->
	<!-- TMPL_IF NAME="heading-modify-tag-p" -->Modify tag<!-- /TMPL_IF -->
	<!-- TMPL_IF NAME="heading-add-tag-p" -->Add tag<!-- /TMPL_IF -->
	<!-- TMPL_ELSE --><!-- TMPL_VAR NAME="action" --><!-- /TMPL_IF -->
	</h1>
	<form action="<!-- TMPL_VAR NAME="script_name" -->" name="Aform" method="post">
		<input type="hidden" name="op" value="add_validate">
		<input type="hidden" name="frameworkcode" value="<!-- TMPL_VAR NAME="frameworkcode" -->">
		<p><label>Tag<label><!-- TMPL_IF Name="searchfield" -->
		<!-- TMPL_VAR NAME="searchfield" -->
		<!-- TMPL_ELSE -->
		<input type="text" name="tagfield" value="" escape=HTML -->
		<!-- /TMPL_IF -->
		</p>
		<p><label>Lib for librarians</label><input type="text" name="liblibrarian" value="<!-- TMPL_VAR NAME="liblibrarian" escape=HTML -->" size="80" maxlength="100"></p>
		<p><label>Lib for opac</label><input type="text" name="libopac" value="<!-- TMPL_VAR NAME="libopac" escape=HTML -->" size="80" maxlength="100"></p>
		<p><label>Repeatable</label><!-- TMPL_VAR NAME="repeatable" --></p>
		<p><label>Mandatory</label><!-- TMPL_VAR NAME="mandatory" --></p>
		<p><label>Authorised value</label><!-- TMPL_VAR NAME="authorised_value" --> (if you select a value here, the indicators will be limited to the authorised value list)</p>
		<p><label>&nbsp;</label><input type="button" value="OK" class="button" onclick="Check(this.form)"></p>
	</form>
<!-- /TMPL_IF -->


<!-- TMPL_IF NAME="delete_confirm" -->
<!-- ------------------------------------------------------------------------ -->
<table>
	<tr>
		<td>tag</td>
		<td><!-- TMPL_VAR NAME="searchfield" --></td>
	</tr>
	<tr><td>&nbsp;</td><td><!-- TMPL_VAR NAME="liblibrarian" --></td></tr>
	<form action="<!-- TMPL_VAR NAME="script_name" -->" method="post"><input type="hidden" name="op" value="delete_confirmed"><input type="hidden" name="searchfield" value="<!-- TMPL_VAR NAME="searchfield" -->"><input type="hidden" name="frameworkcode" value="<!-- TMPL_VAR NAME="frameworkcode" -->">
	<tr><td colspan="2" align="center">CONFIRM DELETION</td></tr>
	<tr><td><input type="submit" value="YES"></form></td><td><form action="<!-- TMPL_VAR NAME="script_name" -->" method="post"><input type="submit" value="NO"></form></td></tr>
<!-- /TMPL_IF -->

<!-- TMPL_IF NAME="delete_confirmed" -->
<!-- ------------------------------------------------------------------------ -->
	Data deleted
	<form action="<!-- TMPL_VAR NAME="script_name" -->" method="post"><input type="hidden" name="frameworkcode" value="<!-- TMPL_VAR NAME="frameworkcode" -->">
	<input type="submit" value="OK">
	</form>
<!-- /TMPL_IF -->
<!-- TMPL_IF NAME="framework_create" -->
<!-- ------------------------------------------------------------------------ -->
	<form action="<!-- TMPL_VAR NAME="script_name" -->" method="post">
		<input type="hidden" name="op" value="framework_create_confirm">
		<input type="hidden" name="frameworkcode" value="<!-- TMPL_VAR NAME="frameworkcode" -->">
		Create framework for <!-- TMPL_VAR NAME="frameworkcode" --> (<!-- TMPL_VAR NAME="frameworktext" -->) using
		<select name="existingframeworkcode">
			<option value="">Default</option>
		<!-- TMPL_LOOP NAME="existingframeworkloop" -->
			<option value="<!-- TMPL_VAR NAME="value" -->"><!-- TMPL_VAR NAME="frameworktext" --></option>
		<!-- /TMPL_LOOP -->
		</select>
		<input type="submit" value="OK" class="button">
	</form>
<!-- /TMPL_IF -->
<!-- ------------------------------------------------------------------------ -->
<!-- TMPL_IF NAME="else" -->
	<div id="bloc25">
	<h2 class="parameters">Select a framework</h2>
	<form name="f" action="<!-- TMPL_VAR NAME="script_name" -->" method="post">
		<select name="frameworkcode">
			<option value="">Default</option>
		<!-- TMPL_LOOP NAME="frameworkloop" -->
			<option value="<!-- TMPL_VAR NAME="value" -->" <!-- TMPL_IF NAME="selected" -->selected<!-- /TMPL_IF -->><!-- TMPL_VAR NAME="frameworktext" --></option>
		<!-- /TMPL_LOOP -->
		</select>
		<input type="text" name="searchfield" value="<!-- TMPL_VAR NAME="searchfield" -->">
		<input type="submit" value="OK" class="button">
		<p><!-- TMPL_IF Name="select_display"-->
				<i>Display only used Tags/Subfields</i> <input type="checkbox" name="select_display" value="True" checked OnChange="javascript:document.f.submit()">
			<!-- TMPL_ELSE -->
				<i>Display only used Tags/Subfields</i> <input type="checkbox" name="select_display" value="True" OnChange="javascript:document.f.submit()">
			<!--/TMPL_IF --> 
		</p>
	</form>
	<b>NOTE : if you change the link between a MARC subfield and a non-MARC field, ask your administrator to run misc/rebuildnonmarc.pl script.</b>
	</div>
	<div id="bloc100">
	<table>
		<tr>
			<th>Tag</th>
			<th>Lib</th>
			<th>Repeatable</th>
			<th>Mandatory</th>
			<th>Authorised<br />value</th>
			<th>Subfields</th>
			<th>Edit</th>
			<th>Delete</th>
		<tr>
	<!-- TMPL_IF NAME="select_display" -->
		<!-- TMPL_LOOP NAME="loop" -->
		<tr class="hilighted">
			<td><b><!-- TMPL_VAR NAME="tagfield" --></b></td>
			<td><!-- TMPL_VAR NAME="liblibrarian" --></td>
			<td><!-- TMPL_IF NAME="repeatable" -->Yes<!-- TMPL_ELSE -->No<!-- /TMPL_IF --></td>
			<td><!-- TMPL_IF NAME="mandatory" -->Yes<!-- TMPL_ELSE -->No<!-- /TMPL_IF --></td>
			<td><!-- TMPL_VAR NAME="authorised_value" --></td>
			<td><a href="<!-- TMPL_VAR NAME="subfield_link" -->" class="button">subfields</a></td>
			<td><a href="<!-- TMPL_VAR NAME="edit" -->"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/fileopen.png"  width="32" hspace="0" vspace="0" border="0"></a></td>
			<td><a href="<!-- TMPL_VAR NAME="delete" -->"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/edittrash.png" width="32" hspace="0" vspace="0" border="0"></a></td>
		</tr>
		<tr valign="top" bgcolor="<!-- TMPL_VAR NAME="bgcolor" -->">
			<td>
				&nbsp;
			</td>
			<td colspan=7 border=0>
				<!-- TMPL_LOOP NAME="subfields" -->
					<p><label>&nbsp;</label>
							Tab:<!-- TMPL_VAR NAME="tab" --> | $<!-- TMPL_VAR NAME="tagsubfield" -->
							<!-- TMPL_VAR NAME="liblibrarian" --> <!-- TMPL_IF NAME="kohafield" --><!-- TMPL_VAR NAME="kohafield" --><!--/TMPL_IF --><!-- TMPL_IF NAME="repeatable" -->, repeatable<!-- /TMPL_IF --><!-- TMPL_IF NAME="mandatory" -->, Mandatory<!-- /TMPL_IF --><!-- TMPL_IF NAME="seealso" -->, See <!-- TMPL_VAR name="seealso" --><!--/TMPL_IF --><!-- TMPL_IF NAME="authorised_value" -->, <!-- TMPL_VAR NAME="authorised_value" --><!--/TMPL_IF --><!-- TMPL_IF NAME="authtypecode" -->, <!-- TMPL_VAR NAME="authtypecode" --><!--/TMPL_IF --><!-- TMPL_IF NAME="value_builder" -->, <!-- TMPL_VAR NAME="value_builder" --><!--/TMPL_IF -->
					</p>
				<!-- /TMPL_LOOP -->
			</td>
		</tr>
		<!-- /TMPL_LOOP -->
	<!-- TMPL_ELSE -->
		<!-- TMPL_LOOP NAME="loop" -->
		<tr valign="top" bgcolor="<!-- TMPL_VAR NAME="bgcolor" -->">
			<td><b><!-- TMPL_VAR NAME="tagfield" --></b></td>
			<td><!-- TMPL_VAR NAME="liblibrarian" --></td>
			<td><!-- TMPL_IF NAME="repeatable" -->Yes<!-- TMPL_ELSE -->No<!-- /TMPL_IF --></td>
			<td><!-- TMPL_IF NAME="mandatory" -->Yes<!-- TMPL_ELSE -->No<!-- /TMPL_IF --></td>
			<td><!-- TMPL_VAR NAME="authorised_value" --></td>
			<td><a href="<!-- TMPL_VAR NAME="subfield_link" -->" class="button">subfields</a></td>
			<td><a href="<!-- TMPL_VAR NAME="edit" -->"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/fileopen.png"  width="32" hspace="0" vspace="0" border="0"></a></td>
			<td><a href="<!-- TMPL_VAR NAME="delete" -->"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/edittrash.png" width="32" hspace="0" vspace="0" border="0"></a></td>
		</tr>
		<!-- /TMPL_LOOP -->
	<!--/TMPL_IF -->
	<form action="<!-- TMPL_VAR NAME="script_name" -->" method="post">
	<input type="hidden" name="op" value="add_form">
	</table>
	<form action="<!-- TMPL_VAR NAME="script_name" -->" method="post">
		<input type="hidden" name="op" value="add_form">
	<input type="hidden" name="frameworkcode" value="<!-- TMPL_VAR NAME="frameworkcode" -->">
		<input type="submit" class="button" value="Add Tag" title="Add Tag" alt="Add Tag" >
		<!-- TMPL_IF NAME="isprevpage" -->
			<a href="<!-- TMPL_VAR NAME="script_name" -->?offset=<!-- TMPL_VAR NAME="prevpage" -->&amp;searchfield=<!-- TMPL_VAR NAME="searchfield" -->&amp;frameworkcode=<!-- TMPL_VAR NAME="frameworkcode" --><!--TMPL_IF Name="select_display"-->&amp;select_display=True<!--/TMPL_IF -->">
			<input type="image" src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/1leftarrow.png" title="previous" alt="previous" border="0">
			</a>
		<!-- /TMPL_IF -->
		<!-- TMPL_IF NAME="nextpage" -->
			<a href="<!-- TMPL_VAR NAME="script_name" -->?offset=<!-- TMPL_VAR NAME="nextpage" -->&amp;searchfield=<!-- TMPL_VAR NAME="searchfield" -->&amp;frameworkcode=<!-- TMPL_VAR NAME="frameworkcode" --><!--TMPL_IF Name="select_display"-->&amp;select_display=True<!--/TMPL_IF -->">
				<input type="image" src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/1rightarrow.png" title="next" alt="next" border="0">
			</a>
		<!-- /TMPL_IF -->
</form>
</div>
<!-- /TMPL_IF -->

</div>
<!-- TMPL_INCLUDE NAME="parameters-bottom.inc" -->
