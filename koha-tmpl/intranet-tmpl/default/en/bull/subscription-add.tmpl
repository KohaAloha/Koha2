<!-- TMPL_INCLUDE NAME="bull-top.inc" -->
<!--------------------------MAIN BODY OF PAGE-------------------------->
<div id="mainbloc">
<!-- TMPL_IF name="mod" -->
	<h1 class="bull">Modify subscription</h1>
	<form method="post" name="f" action="subscription-detail.pl">
		<input type="hidden" name="op" value="modsubscription">
		<input type="hidden" name="subscriptionid" value="<!-- TMPL_VAR name="subscriptionid" -->">
<!-- TMPL_ELSE -->
	<h1 class="bull">Add a subscription</h1>
	<form method="post" name="f">
<!-- /TMPL_IF -->
<div id="bloc25">
	<h2 class="bull">Subscription information</h2>
		<input type="hidden" name="op" value="addsubscription">
		<input type="hidden" name="user" value="<!-- TMPL_VAR name="user" -->">
		<p>Librarian</td><td> <!-- TMPL_VAR name="user" --></p>
		<p><label>Supplier (*):</label><input type="text" name="aqbooksellerid" value="<!-- TMPL_VAR name="aqbooksellerid"-->"><a href="#" OnClick="FindAcqui()">...</a></p>
		<p><label>Cost</label><input type="text" name="cost" value="<!-- TMPL_VAR name="cost" -->"></label></p>
		<p><label>Budget</label><input type="text" name="aqbudgetid" value="<!-- TMPL_VAR name="aqbudgetid" -->"></p>
	<p><label>Biblio</label><input type="text" name="biblionumber" value="<!-- TMPL_VAR name="biblionumber" -->"> <a href="#" onClick="Plugin(f)">...</a></p>
	<p><label>Notes</label><TEXTAREA NAME="notes" COLS=30 ROWS=2><!-- TMPL_VAR name="notes" --></TEXTAREA></p>
</div>
<div id="bloc25">
	<h2 class="bull">Planning</h2>
	<p><label class="label100">Beginnning date:</label> <input type="text" name="startdate" value="<!-- TMPL_VAR name="startdate" -->"></p>
	<p><label class="label100">Frequency (*)</label>
			<select name="periodicity" size="1">
				<option value="" selected>None</option>
				<!-- TMPL_IF name="periodicity1" -->
					<option value="1" selected>1/day</option>
				<!-- TMPL_ELSE -->
					<option value="1">1/day</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity2" -->
					<option value="2" selected>1 week</option>
				<!-- TMPL_ELSE -->
					<option value="2">1 week</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity3" -->
					<option value="3" selected>2 weeks</option>
				<!-- TMPL_ELSE -->
					<option value="3">2 weeks</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity4" -->
					<option value="4" selected>3 weeks</option>
				<!-- TMPL_ELSE -->
					<option value="4">3 weeks</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity5" -->
					<option value="5" selected>1 month</option>
				<!-- TMPL_ELSE -->
					<option value="5">1 month</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity6" -->
					<option value="6" selected>2 months</option>
				<!-- TMPL_ELSE -->
					<option value="6">2 months</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity7" -->
					<option value="7" selected>3 months</option>
				<!-- TMPL_ELSE -->
					<option value="7">3 months</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity8" -->
					<option value="8" selected>1 quarter</option>
				<!-- TMPL_ELSE -->
					<option value="8">1 quarter</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity9" -->
					<option value="9" selected>2 quarters</option>
				<!-- TMPL_ELSE -->
					<option value="9">2 quarters</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity10" -->
					<option value="10" selected>1 year</option>
				<!-- TMPL_ELSE -->
					<option value="10">1 year</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="periodicity11" -->
					<option value="11" selected>2 years</option>
				<!-- TMPL_ELSE -->
					<option value="11">2 years</option>
				<!-- /TMPL_IF -->
			</select>
	</p>
	<p><label class="label100">Arrives on</label>
			<select name="dow" size="1">
				<option value="">None</option>
				<!-- TMPL_IF name="dow1" -->
					<option value="1" selected>Monday</option>
				<!-- TMPL_ELSE -->
					<option value="1">Monday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow2" -->
					<option value="2" selected>Tuesday</option>
				<!-- TMPL_ELSE -->
					<option value="2">Tuesday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow3" -->
					<option value="3" selected>Wednesday</option>
				<!-- TMPL_ELSE -->
					<option value="3">Wednesday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow4" -->
					<option value="4" selected>Thursday</option>
				<!-- TMPL_ELSE -->
					<option value="4">Thursday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow5" -->
					<option value="5" selected>Friday</option>
				<!-- TMPL_ELSE -->
					<option value="5">Friday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow6" -->
					<option value="6" selected>Saturday</option>
				<!-- TMPL_ELSE -->
					<option value="6">Saturday</option>
				<!-- /TMPL_IF -->
				<!-- TMPL_IF name="dow7" -->
					<option value="7" selected>Sunday</option>
				<!-- TMPL_ELSE -->
					<option value="7">Sunday</option>
				<!-- /TMPL_IF -->
			</select>
</div>
<div id="bloc25">
	<h2 class="bull">Subscription length</h2>
	<p><label class="label100">Number of num</label><input type="text" name="numberlength" value="<!-- TMPL_VAR name="numberlength" -->"></p>
	<p><label class="label100">Number of weeks</label><input type="text" name="weeklength" value="<!-- TMPL_VAR name="weeklength" -->"></p>
	<p><label class="label100">Number of months</label><input type="text" name="monthlength" value="<!-- TMPL_VAR name="monthlength" -->"></p>

</div>
<div id="bloc25">
	<h2 class="bull">Numbering calculation</h2>
	<p>
		<p>Numbering formula: <input type="text" name="numberingmethod" value="<!-- TMPL_VAR name="numberingmethod" -->"></p>
		<table class="small">
			<tr>
				<th class="bull">&nbsp;</th>
				<th class="bull">X</th>
				<th class="bull">Y</th>
				<th class="bull">Z</th>
			</tr>
			<tr>
				<td class="bull">Evolution</td>
				<td>
					<select name="seqtype1" size="1" onChange="select(this[this.selectedIndex].value, 'X')">
						<option value="">None</option>
						<!-- TMPL_IF name="seqtype11" -->
							<option value="1" selected>Added each</option>
						<!-- TMPL_ELSE -->
							<option value="1">Added each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype12" -->
							<option value="2" selected>Reinitialize each</option>
						<!-- TMPL_ELSE -->
							<option value="2">Reinitialize each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype13" -->
							<option value="3" selected>Constant</option>
						<!-- TMPL_ELSE -->
							<option value="3">Constant</option>
						<!-- /TMPL_IF -->
						</select>
				</td>
				<td>
					<select name="seqtype2" size="1" onChange="select(this[this.selectedIndex].value, 'Y')">
						<option value="" selected>None</option>
						<!-- TMPL_IF name="seqtype21" -->
							<option value="1" selected>Added each</option>
						<!-- TMPL_ELSE -->
							<option value="1">Added each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype22" -->
							<option value="2" selected>Reinitialize each</option>
						<!-- TMPL_ELSE -->
							<option value="2">Reinitialize each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype23" -->
							<option value="3" selected>Constant</option>
						<!-- TMPL_ELSE -->
							<option value="3">Constant</option>
						<!-- /TMPL_IF -->
						</select>
				</td>
				<td>
					<select name="seqtype3" size="1" onChange="select(this[this.selectedIndex].value, 'Z')">
						<option value="" selected>None</option>
						<!-- TMPL_IF name="seqtype31" -->
							<option value="1" selected>Added each</option>
						<!-- TMPL_ELSE -->
							<option value="1">Added each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype32" -->
							<option value="2" selected>Reinitialize each</option>
						<!-- TMPL_ELSE -->
							<option value="2">Reinitialize each</option>
						<!-- /TMPL_IF -->
						<!-- TMPL_IF name="seqtype33" -->
							<option value="3" selected>Constant</option>
						<!-- TMPL_ELSE -->
							<option value="3">Constant</option>
						<!-- /TMPL_IF -->
						</select>
				</td>
			</tr>
			<tr>
				<td class="bull">Value</td>
				<td><input type="text" name="seqnum1" value="<!-- TMPL_VAR name="seqnum1" -->"></td>
				<td><input type="text" name="seqnum2" value="<!-- TMPL_VAR name="seqnum2" -->"></td>
				<td><input type="text" name="seqnum3" value="<!-- TMPL_VAR name="seqnum3" -->"></td>
			</tr>
			<tr>
				<td class="bull">Frequency</td>
				<td><input type="text" name="freq1" value="<!-- TMPL_VAR name="freq1" -->"></td>
				<td><input type="text" name="freq2" value="<!-- TMPL_VAR name="freq2" -->"></td>
				<td><input type="text" name="freq3" value="<!-- TMPL_VAR name="freq3" -->"></td>
			</tr>
			<tr>
				<td class="bull">Step</td>
				<td><input type="text" name="step1" value="<!-- TMPL_VAR name="step1" -->"></td>
				<td><input type="text" name="step2" value="<!-- TMPL_VAR name="step2" -->"></td>
				<td><input type="text" name="step3" value="<!-- TMPL_VAR name="step3" -->"></td>
			</tr>
		</table>
<td>Arrival date : </td><td>	<input type="text" name="arrivalplanified" value="<!-- TMPL_VAR name="arrivalplanified" -->">
</div>
<!-- TMPL_IF name="mod" -->
	<input type="button" value="Save subscription" onclick="Check(this.form)" accesskey="w" class="button bull">
<!-- TMPL_ELSE -->
	<input type="button" value="Add subscription" onclick="Check(this.form)" accesskey="w" class="button bull">
<!-- /TMPL_IF -->
</div>

</form>
<!-- TMPL_INCLUDE NAME="bull-bottom.inc" -->

<script language="JavaScript" type="text/javascript">

select(<!--TMPL_VAR name="seqtype1"-->, 'X');
select(<!--TMPL_VAR name="seqtype2"-->, 'Y');
select(<!--TMPL_VAR name="seqtype3"-->, 'Z');

function Plugin(f)
{
	 window.open("subscription-bib-search.pl","Find a bib index",'width=500,height=400,toolbar=false,scrollbars=yes');
}

function FindAcqui(f)
{
	 window.open("acqui-search.pl","Find a supplier",'width=500,height=400,toolbar=false,scrollbars=yes');
}


function Check(f)
{
  if (f.aqbooksellerid.value.length != 0 && f.dow.value.length != 0
	&& f.startdate.value.length != 0 && f.dow.value.length != 0
	&& f.periodicity.value.length != 0)
	{
// 		alert('subscription ok');
		document.f.submit();
        }
else
{
 	alert('field marked with * are mandatory');
}
	return false;
}

function select(reponse, type)
{
 if (type == 'X')
     {
	if (reponse == 0)
	{
	   document.f.step1.style.backgroundColor="#DCDCDC";	
	   document.f.step1.value = "";
	   document.f.step1.disabled = true;
	   document.f.freq1.style.backgroundColor="#DCDCDC";	
	   document.f.freq1.value = "";
	   document.f.freq1.disabled = true;
	   document.f.seqnum1.style.backgroundColor="#DCDCDC";	
	   document.f.seqnum1.value = "";
	   document.f.seqnum1.disabled = true;
	   
        }
	if (reponse == 1)
	{
	   document.f.step1.style.backgroundColor="#FFFFFF";	
	   document.f.step1.disabled = false;
	   document.f.freq1.style.backgroundColor="#DCDCDC";	
	   document.f.freq1.value = "";
	   document.f.freq1.disabled = true;
	   document.f.seqnum1.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum1.disabled = false;
        }	
	if (reponse == 2)
	{
	   document.f.step1.style.backgroundColor="#FFFFFF";	
	   document.f.step1.disabled = false;
	   document.f.freq1.style.backgroundColor="#FFFFFF";	
	   document.f.freq1.disabled = false;
	   document.f.seqnum1.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum1.disabled = false;
        }
	if (reponse == 3)
	{
	   document.f.step1.style.backgroundColor="#DCDCDC";	
	   document.f.step1.value = "";
	   document.f.step1.disabled = true;
	   document.f.freq1.style.backgroundColor="#DCDCDC";	
	   document.f.freq1.value = "";
	   document.f.freq1.disabled = true;
	   document.f.seqnum1.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum1.disabled = false;
        }
     }
 if (type == 'Y')
     {
	if (reponse == 0)
	{
	   document.f.step2.style.backgroundColor="#DCDCDC";	
	   document.f.step2.value = "";
	   document.f.step2.disabled = true;
	   document.f.freq2.style.backgroundColor="#DCDCDC";	
	   document.f.freq2.value = "";
	   document.f.freq2.disabled = true;
	   document.f.seqnum2.style.backgroundColor="#DCDCDC";	
	   document.f.seqnum2.value = "";
	   document.f.seqnum2.disabled = true;
	   
        }
	if (reponse == 1)
	{
	   document.f.step2.style.backgroundColor="#FFFFFF";	
	   document.f.step2.disabled = false;
	   document.f.freq2.style.backgroundColor="#DCDCDC";	
	   document.f.freq2.value = "";
	   document.f.freq2.disabled = true;
	   document.f.seqnum2.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum2.disabled = false;
        }	
	if (reponse == 2)
	{
	   document.f.step2.style.backgroundColor="#FFFFFF";	
	   document.f.step2.disabled = false;
	   document.f.freq2.style.backgroundColor="#FFFFFF";	
	   document.f.freq2.disabled = false;
	   document.f.seqnum2.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum2.disabled = false;
        }
	if (reponse == 3)
	{
	   document.f.step2.style.backgroundColor="#DCDCDC";	
	   document.f.step2.value = "";
	   document.f.step2.disabled = true;
	   document.f.freq2.style.backgroundColor="#DCDCDC";	
	   document.f.freq2.value = "";
	   document.f.freq2.disabled = true;
	   document.f.Y.style.backgroundColor="#FFFFFF";	
	   document.f.Y.disabled = false;
        }

     }
 if (type == 'Z')
     {
	if (reponse == 0)
	{
	   document.f.step3.style.backgroundColor="#DCDCDC";	
	   document.f.step3.value = "";
	   document.f.step3.disabled = true;
	   document.f.freq3.style.backgroundColor="#DCDCDC";	
	   document.f.freq3.value = "";
	   document.f.freq3.disabled = true;
	   document.f.seqnum3.style.backgroundColor="#DCDCDC";	
	   document.f.seqnum3.value = "";
	   document.f.seqnum3.disabled = true;
	   
        }
	if (reponse == 1)
	{
	   document.f.step3.style.backgroundColor="#FFFFFF";	
	   document.f.step3.disabled = false;
	   document.f.freq3.style.backgroundColor="#DCDCDC";	
	   document.f.freq3.value = "";
	   document.f.freq3.disabled = true;
	   document.f.seqnum3.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum3.disabled = false;
        }	
	if (reponse == 2)
	{
	   document.f.step3.style.backgroundColor="#FFFFFF";	
	   document.f.step3.disabled = false;
	   document.f.freq3.style.backgroundColor="#FFFFFF";	
	   document.f.freq3.disabled = false;
	   document.f.seqnum3.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum3.disabled = false;
        }
	if (reponse == 3)
	{
	   document.f.step3.style.backgroundColor="#DCDCDC";	
	   document.f.step3.value = "";
	   document.f.step3.disabled = true;
	   document.f.freq3.style.backgroundColor="#DCDCDC";	
	   document.f.freq3.value = "";
	   document.f.freq3.disabled = true;
	   document.f.seqnum3.style.backgroundColor="#FFFFFF";	
	   document.f.seqnum3.disabled = false;
        }

     }
}

</script>