<TMPL_IF NAME="opac">
    <TMPL_INCLUDE NAME="opac-top.inc">
<TMPL_ELSE>
    <TMPL_INCLUDE NAME="cat-top.inc">
</TMPL_IF>

<span style="font-size:2em; text-align:left;">Recherche MARC</span>

<center>
<form name="f" method="post">
<input type="hidden" name="type" value="intranet">
	<table border=0 cellspacing=0 cellpadding=2 width="80%>
		<tr align="center">
			<td colspan=3>
				<div name="sql">
				<input type="hidden" name="op" value="do_search">
				<textarea name="sql" rows=5 cols=60 disabled readonly></textarea>
				</div>
			</td>
			<td colspan=2 bgcolor="#ad11ad" valign="top" align="left">
				<span style="color:#FFFFFF;">
					<b>AIDE :</b><br/>
					Construisez votre requète en utilisant les champs MARC.
					OK affichera la liste des notices correspondant à vos critères.
				</span>
			</td>
		</tr>


		<!-- 000000000000000000000000000000000000000000000000000000 -->
		<tr>
			<td>
				<input type=hidden name="and_or" value="">&nbsp;
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">non</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">Egale</option>
					<option value=">">Supérieur à</option>
					<option value=">=">Supérieur ou égal à</option>
					<option value="<">Inférieur à</option>
					<option value="<=">Inférieur ou égal à</option>
					<option value="start">Commence par</option>
					<option value="contains">Contient</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr>
			<td>
				<select name="and_or" size="1" onchange="sql_update()">
					<option value="and">et</option>
					<option value="or">ou</option>
				</select>
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">non</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">Egale</option>
					<option value=">">Supérieur à</option>
					<option value=">=">Supérieur ou égal à</option>
					<option value="<">Inférieur à</option>
					<option value="<=">Inférieur ou égal à</option>
					<option value="start">Commence par</option>
					<option value="contains">Contient</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr>
			<td>
				<select name="and_or" size="1" onchange="sql_update()">
					<option value="and">et</option>
					<option value="or">ou</option>
				</select>
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">not</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">Egale</option>
					<option value=">">Supérieur à</option>
					<option value=">=">Supérieur ou égal à</option>
					<option value="<">Inférieur à</option>
					<option value="<=">Inférieur ou égal à</option>
					<option value="start">Commence par</option>
					<option value="contains">Contient</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr><td colspan=5 align=center><input type="submit" value="OK"></td></tr>
	</table>
</form>
<script>
function sql_update() {
document.f.sql.value="";
	for (i=0 ; i<document.f.marclist.length ; i++) {
		if (document.f.marclist[i].value != '') {
			document.f.sql.value = document.f.sql.value+
										document.f.and_or[i].value + ' (' +
										document.f.excluding[i].value + ' ' +
										document.f.marclist[i].value + '' +
										document.f.operator[i].value + '' +
										'\''+document.f.value[i].value + '\') ';
		}
	}
}
</script>
<TMPL_IF NAME="opac">
    <TMPL_INCLUDE NAME="opac-bottom.inc">
<TMPL_ELSE>
    <TMPL_INCLUDE NAME="cat-bottom.inc">
</TMPL_IF>
