<!-- TMPL_INCLUDE NAME="cat-top.inc" -->
<div id="mainbloc">
	<form method="post" action="additem.pl" name="f">
	<input type="hidden" name="op" value="<!-- TMPL_VAR NAME="op" -->">
	<input type="hidden" name="bibid" value="<!-- TMPL_VAR NAME="bibid" -->">
		<h2 class="catalogue">
			Notice MARC : <!-- TMPL_VAR NAME="biblionumber" -->
		</h2>
	<div id="bloc25">
		<div name="10XX" id="10XX">
		<h2 class="catalogue">Documents existants</h2>
		<table>
			<tr>
				<!-- TMPL_LOOP NAME="item_header_loop" -->
					<th class="catalogue">
						<TMPL_VAR NAME="header_value">
					</th>
				<!-- /TMPL_LOOP -->
				<th colspan="2" class="catalogue">&nbsp;</th>
			</tr>
				<!-- TMPL_LOOP NAME="item_loop" -->
				<tr>
					<!-- TMPL_VAR NAME="item_value" -->
					<td><a href="additem.pl?op=edititem&amp;bibid=<!-- TMPL_VAR NAME="bibid" -->&amp;itemnum=<!-- TMPL_VAR NAME="itemnum" -->"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/fileopen.png" border="0"></a></td>
					<td><a href="javascript:confirm_deletion(<!-- TMPL_VAR NAME="bibid" -->,<!-- TMPL_VAR NAME="itemnum" -->)"><img src="<!-- TMPL_VAR NAME="interface" -->/<!-- TMPL_VAR NAME="theme" -->/images/edittrash.png" border="0"></a></td>
				</tr>
				<!-- /TMPL_LOOP -->
		</table>
		</div>
	</div>
	<div id="bloc100">
	<!-- TMPL_IF name="opisadd" -->
		<h2 class="catalogue">Nouvel Exemplaire</h2>
	<!-- TMPL_ELSE -->
		<h2 class="catalogue">Modifier l'exemplaire</h2>
	<!-- /TMPL_IF -->	
		<!-- TMPL_LOOP NAME="item" -->
			<p>
					<label><!-- TMPL_VAR NAME="subfield" --> - <!-- TMPL_IF name="mandatory" --><b><!-- /TMPL_IF --><!-- TMPL_VAR NAME="marc_lib" --><!-- TMPL_IF name="mandatory" --> *</b><!-- /TMPL_IF --></label>
					<!-- TMPL_VAR NAME="marc_value" -->
					<input type="hidden" name="tag" value="<!-- TMPL_VAR NAME="tag" -->">
					<input type="hidden" name="subfield" value="<!-- TMPL_VAR NAME="subfield" -->">
					<input type="hidden" name="mandatory" value="<!-- TMPL_VAR NAME="mandatory" -->">
			</p>
		<!-- /tmpl_loop -->
	<input type="hidden" name="itemnum" value="<!-- TMPL_VAR NAME="itemnum" -->">
	<!-- TMPL_IF name="barcode_not_unique" -->
		<div id="problem"><b>ERREUR : Code à barres déjà utilisé!<b></div>
	<!-- /TMPL_IF -->
	<!-- TMPL_IF name="opisadd" -->
	<input type="button" value="Ajouter un document" onclick="Check(this.form)" accesskey="w" class="button catalogue">
	<!-- TMPL_ELSE -->
	<input type="hidden" name="tag" value="<!-- TMPL_VAR NAME="itemtagfield" -->">
	<input type="hidden" name="subfield" value="<!-- TMPL_VAR NAME="itemtagsubfield" -->">
	<input type="hidden" name="field_value" value="<!-- TMPL_VAR NAME="itemnum" -->">
	<input type="button" value="Modifier l'exemplaire" onclick="Check(this.form)" accesskey="w" class="button catalogue">
	<!-- /TMPL_IF -->
	</center>
	</form>
</div>
<script LANGUAGE="JavaScript">
function _(s) { return s } // dummy function for gettext
function active(numlayer)
{
	for (i=10; i < 11 ; i++ ) {
		ong = i+"XX";
			link = "link"+i;
		if (numlayer==i) {
			document.getElementById(ong).style.visibility="visible";
			document.getElementById(link).style.backgroundColor="#11AA11";
			document.getElementById(link).style.backgroundImage="url(<!-- TMPL_VAR NAME="themelang" -->/images/background-mem.gif)";
		} else {
			document.getElementById(ong).style.visibility="hidden";
			document.getElementById(link).style.backgroundColor="#FFFFFF";
			document.getElementById(link).style.backgroundImage="";
		}
	}
}
function Check(f) {
	var total_errors=0;
//	alert(f.field_value.length);
	for (i=0 ; i<f.field_value.length ; i++) {
//	alert (f.field_value[i].value);
		if (f.field_value[i].value.length==0 && f.mandatory[i].value==1) {
			document.getElementById("error"+i).style.backgroundColor="#FF0000";
			total_errors++;
		} else {
//			document.getElementById("error"+i).style.backgroundColor="#FFFFFF";
		}
	}
	var alertString2;
	if (total_errors==0) {
		document.f.submit();
	} else {
		alertString2  = _("Formulaire non soumis à cause du (des) problème(s) suivant(s)");
		alertString2 += "\n------------------------------------------------------------------------------------\n";
		alertString2 += "\n- "+ total_errors+_("champs obligatoires non renseignés (voir les champs en caractère gras)");
		alert(alertString2);
	}
}
function Dopop(link,i) {
	defaultvalue=document.forms[0].field_value[i].value;
	newin=window.open(link+"&result="+defaultvalue,"value builder",'width=500,height=400,toolbar=false,scrollbars=yes');
}
function confirm_deletion(bibid,itemnum) {
	var is_confirmed = confirm(_('Confirmez-vous la suppression de l exemplaire ?'));
	if (is_confirmed) {
	window.location = "additem.pl?op=delitem&bibid="+bibid+"&itemnum="+itemnum;
	}
}
</script>
</body>
</html>
