<TMPL_IF NAME="opac">
    <TMPL_INCLUDE NAME="opac-top.inc">
<TMPL_ELSE>
    <TMPL_INCLUDE NAME="cat-top.inc">
</TMPL_IF>

<center>

<form name="f" method="post">
<input type="hidden" name="type" value="intranet">
	<table border=0 cellspacing=0 cellpadding=2>
		<tr
		<TMPL_IF NAME="opac">
			bgcolor="#ad11ad"
				bgcolor="#99cccc" background="/images/background-opac.gif"
			<TMPL_ELSE>
				bgcolor="#ad11ad"
			</TMPL_IF>
		>
			<th colspan=6>Search</th>
		</tr>
		<tr align="center">
			<td colspan=6>
			<div name="sql">
			<input type="hidden" name="op" value="do_search">
			<textarea name="sql" rows=5 cols=80 disabled readonly></textarea>
			</td>
		</tr>

		<!-- 000000000000000000000000000000000000000000000000000000 -->
		<tr>
			<td>
				<input type=hidden name="and_or" value="">&nbsp;
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">not</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">equals</option>
					<option value=">">is more than</option>
					<option value=">=">is more than or equal to</option>
					<option value="<">is less than</option>
					<option value="<=">is less than or equal to</option>
					<option value="start">starts with</option>
					<option value="contains">contains</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr>
			<td>
				<select name="and_or" size="1" onchange="sql_update()">
					<option value="and">and</option>
					<option value="or">or</option>
				</select>
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">not</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">equals</option>
					<option value=">">is more than</option>
					<option value=">=">is more than or equal to</option>
					<option value="<">is less than</option>
					<option value="<=">is less than or equal to</option>
					<option value="start">starts with</option>
					<option value="contains">contains</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr>
			<td>
				<select name="and_or" size="1" onchange="sql_update()">
					<option value="and">and</option>
					<option value="or">or</option>
				</select>
			</td>
			<td><TMPL_VAR name="marclist"></td>
			<td>
				<select name="excluding" size="1" onchange="sql_update()">
					<option value=""> </option>
					<option value="not">not</option>
				</select>
			</td>
			<td>
				<select name="operator" size="1" onchange="sql_update()">
					<option value="=">equals</option>
					<option value=">">is more than</option>
					<option value=">=">is more than or equal to</option>
					<option value="<">is less than</option>
					<option value="<=">is less than or equal to</option>
					<option value="start">starts with</option>
					<option value="contains">contains</option>
				</select>
			</td>
			<td><input type="text" name="value" onChange="sql_update()"></td>
		</tr>
		<tr><td colspan=5 align=center><input type="submit" value="OK"></td></tr>
	</table>
</form>
<script>
function sql_update() {
document.f.sql.value="";
	for (i=0 ; i<document.f.marclist.length ; i++) {
		if (document.f.marclist[i].value != '') {
			document.f.sql.value = document.f.sql.value+
										document.f.and_or[i].value + ' (' +
										document.f.excluding[i].value + ' ' +
										document.f.marclist[i].value + '' +
										document.f.operator[i].value + '' +
										'\''+document.f.value[i].value + '\') ';
		}
	}
}
</script>
<TMPL_IF NAME="opac">
    <TMPL_INCLUDE NAME="opac-bottom.inc">
<TMPL_ELSE>
    <TMPL_INCLUDE NAME="cat-bottom.inc">
</TMPL_IF>
