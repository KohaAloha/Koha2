<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->Koha -- Catalog: Advanced MARC Search<!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="masthead.inc" -->
<!-- TMPL_INCLUDE NAME="intranet-nav.inc" -->

<div id="main">
<h1>Advanced MARC Search</h1>
<form name="f" method="post" action="search.pl">

<input type="hidden" name="op" value="do_search" />
<input type="hidden" name="type" value="intranet" />
<input type="hidden" name="nbstatements" value="<!-- TMPL_VAR NAME="nbstatements" -->" />
<div class="table">
<div class="form">
<table>
<caption>Quick Search</caption>
		<tr>
			<th>Keyword</th>
			<td>
				<input type="hidden" name="marclist" value="">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value=""><input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()">
			</td>
			<th>Illustrator</th>
			<td><input type="hidden" name="marclist" value="biblioitems.illus">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value=""><input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()"></td>
		</tr>
		<tr>
			<th>Title</th>
			<td><input type="hidden" name="marclist" value="biblio.title">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value=""><input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()"></td>
			<th>Dewey</th>
			<td><input type="hidden" name="marclist" value="biblioitems.dewey">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value=""><input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()"></td>
		</tr>
		<tr>
			<th>
				Author <input type="hidden" name="marclist" value="biblio.author">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
			</th>
			<td>
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()">
			</td>
			<th>
				Item Type <input type="hidden" name="marclist" value="items.itemtype">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
			</th>
			<td>
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value" onchange="sql_update()">
			</td>
		</tr>
		<tr>
			<th>
				Barcode
			</th>
			<td>
				<input type="hidden" name="marclist" value="items.barcode">
				<input type="hidden" name="and_or" value="and">
				<input type="hidden" name="excluding" value="">
				<input type="hidden" name="operator" value="contains">
				<input type="text" name="value">
			</td>
			<td>&nbsp;</td><td>&nbsp;</td>
		</tr>
	</table>
</div>
</div>
<div class="table">
<table>
		<tr>
			<td colspan="2"><h5>Help:</h5>
					<p>Build your request using MARC fields and subfields. Add criteria lets you add another criteria to your search.	Search commits the request and displays the results.</p>
				<div id="sql">
				<textarea name="sql" rows="5" cols="60"></textarea>
				</div>
			</td>
		</tr>

		<!-- TMPL_LOOP NAME="statements" -->
		<tr>
			<td>
				<!-- TMPL_IF NAME="first" -->
					<input type="hidden" name="and_or" value="" />&nbsp;
				<!-- TMPL_ELSE -->
					<select name="and_or" size="1" onchange="sql_update()">
						<option value="and">and</option>
						<option<!-- TMPL_IF NAME="or" --> selected="selected"<!-- /TMPL_IF --> value="or">or</option>
					</select>
				<!-- /TMPL_IF -->
			</td>
			<td><!-- TMPL_VAR name="marclist" --> <select name="excluding" size="1" onchange="sql_update()">
					<option value="0"> </option>
					<option<!-- TMPL_IF NAME="not" --> selected="selected"<!-- /TMPL_IF --> value="1">not</option>
				</select> <select name="operator" size="1" onchange="sql_update()">
					<option<!-- TMPL_IF NAME="eq" --> selected="selected"<!-- /TMPL_IF --> value="=">Is equal to</option>
					<option<!-- TMPL_IF NAME="start" --> selected="selected"<!-- /TMPL_IF --> value="start">Starts with</option>
					<option<!-- TMPL_IF NAME="contains" --> selected="selected"<!-- /TMPL_IF --> value="contains">Contains</option>
					<option<!-- TMPL_IF NAME="gt" --> selected="selected"<!-- /TMPL_IF --> value=">">Is greater than</option>
					<option<!-- TMPL_IF NAME="ge" --> selected="selected"<!-- /TMPL_IF --> value=">=">Is greater or equal to</option>
					<option<!-- TMPL_IF NAME="lt" --> selected="selected"<!-- /TMPL_IF --> value="<">Is lower than</option>
					<option<!-- TMPL_IF NAME="le" --> selected="selected"<!-- /TMPL_IF --> value="<=">Is lower or equal to</option>
				</select> <input type="text" name="value" onChange="sql_update()" <!-- TMPL_IF NAME="value" -->value="<!-- TMPL_VAR NAME="value" -->"<!-- /TMPL_IF --> /></td>
		</tr>
		<!-- /TMPL_LOOP -->
			<tr>
	<td colspan="2"><input type="button" value="Add criteria" onclick="AddStatement(); return false;" class="submit" /> Results per page :
		<select name="resultsperpage" size="1">
			<option value="20">20</option>
			<option value="50">50</option>
			<option value="100">100</option>
		</select>	Ordered by
		<select name="orderby" size="1">
			<option value="biblio.title">Title</option>
			<option value="biblio.author">Author</option>
			<option value="biblioitems.dewey">Dewey</option>
			<option value="biblioitems.publicationyear">Publication Year</option>
			<option value="biblioitems.publishercode">Publisher</option>
		</select>
	<input type="submit" value="Start search" class="submit"></td></tr></table></div>
</form>
</div>

<script language="JavaScript" type="text/javascript">
<!-- 
function sql_update() {
document.f.sql.value="";
	for (i=0 ; i<document.f.marclist.length ; i++) {
		if (document.f.marclist[i].value != '') {
			document.f.sql.value = document.f.sql.value+
										document.f.and_or[i].value + ' (' +
										document.f.excluding[i].value + ' ' +
										document.f.marclist[i].value + ' ' +
										document.f.operator[i].value + ' ' +
										'\''+document.f.value[i].value + '\') ';
		}
	}
}

function AddStatement() {
	document.forms[0].op.value="AddStatement";
	document.f.submit();
}
// -->
</script>

<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->