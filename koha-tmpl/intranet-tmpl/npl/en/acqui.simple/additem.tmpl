<!-- TMPL_INCLUDE NAME="doc-head-open.inc" -->Koha -- Cataloging: Items for Bibliographic Record <!-- TMPL_VAR name="biblionumber" --><!-- TMPL_INCLUDE NAME="doc-head-close.inc" -->
<!-- TMPL_INCLUDE NAME="masthead.inc" -->
<!-- TMPL_INCLUDE NAME="intranet-nav-brief.inc" -->

<div id="main">

<h1>Items for <em><!-- TMPL_VAR name="title" --></em> <!-- TMPL_IF NAME="author" --> by <!-- TMPL_VAR name="author" --><!-- /TMPL_IF --> (Record #<!-- TMPL_VAR NAME="biblionumber" -->)</h1>

		<div class="tabitem"><form action="/cgi-bin/koha/acqui.simple/addbiblio.pl" method="get"><input type="hidden" name="oldbiblionumber" value="<!-- TMPL_VAR name="biblionumber" -->"><input type="submit" class="submit" value="Edit Bibliographic Record"></form></div> <div class="tabitem"><form action="/cgi-bin/koha/detail.pl" method="get"><input type="hidden" name="bib" value="<!-- TMPL_VAR name="biblionumber" -->"> <input type="submit" class="submit" value="View in Catalog"></form> <form action="/cgi-bin/koha/MARCdetail.pl" method="get"><input type="hidden" name="bib" value="<!-- TMPL_VAR name="biblionumber" -->"> <input type="submit" class="submit" value="View MARC in Catalog"></form>  <form action="/cgi-bin/koha/ISBDdetail.pl" method="get"><input type="hidden" name="bib" value="<!-- TMPL_VAR name="biblionumber" -->"> <input type="submit" class="submit" value="View ISBD in Catalog"></form></div>

	<form method="post" action="additem.pl" name="f">
	<input type="hidden" name="op" value="<!-- TMPL_VAR NAME="op" -->" />
	<input type="hidden" name="bibid" value="<!-- TMPL_VAR NAME="bibid" -->">
	<!-- TMPL_IF name="item_loop" -->
			<div name="10XX" id="10XX">
			<table class="editing">
			<caption>Existing items</caption>
				<tr>
					<!-- TMPL_LOOP NAME="item_header_loop" -->
						<th>
							<!-- TMPL_VAR NAME="header_value" -->
						</th>
					<!-- /TMPL_LOOP -->
					<th colspan="2">&nbsp;</th>
				</tr>
					<!-- TMPL_LOOP NAME="item_loop" -->
					<tr>
						<!-- TMPL_VAR NAME="item_value" -->
						<td><a href="additem.pl?op=edititem&amp;bibid=<!-- TMPL_VAR NAME="bibid" -->&amp;itemnum=<!-- TMPL_VAR NAME="itemnum" -->">Edit</a></td>
						<td><a href="javascript:confirm_deletion(<!-- TMPL_VAR NAME="bibid" -->,<!-- TMPL_VAR NAME="itemnum" -->)">Delete</a></td>
					</tr>
					<!-- /TMPL_LOOP -->
			</table>
			</div>
	<!-- /TMPL_IF -->

<div class="data">
	<table>
	<!-- TMPL_IF name="opisadd" -->
		<caption>Add Item</caption>
	<!-- TMPL_ELSE -->
		<caption>Edit Item</caption>
	<!-- /TMPL_IF -->	
		<!-- TMPL_LOOP NAME="item" -->
			<tr>
					<th><label><!-- TMPL_VAR NAME="subfield" --> - <!-- TMPL_IF name="mandatory" --><b><!-- /TMPL_IF --><!-- TMPL_VAR NAME="marc_lib" --><!-- TMPL_IF name="mandatory" --> *</b><!-- /TMPL_IF --></label></th>
					<td><!-- TMPL_VAR NAME="marc_value" -->
					<input type="hidden" name="tag" value="<!-- TMPL_VAR NAME="tag" -->">
					<input type="hidden" name="subfield" value="<!-- TMPL_VAR NAME="subfield" -->">
					<input type="hidden" name="mandatory" value="<!-- TMPL_VAR NAME="mandatory" -->"></td>
		</tr>
		<!-- /tmpl_loop -->
		</table>
	<input type="hidden" name="itemnum" value="<!-- TMPL_VAR NAME="itemnum" -->">
	<!-- TMPL_IF name="barcode_not_unique" -->
		<div class="error"><b>ERROR : Barcode already exists !<b></div>
	<!-- /TMPL_IF -->
	<!-- TMPL_IF name="opisadd" -->
	<input type="button" value="Add item" class="submit"  onClick="Check(this.form)" accesskey="w">
	<!-- TMPL_ELSE -->
	<input type="hidden" name="tag" value="<!-- TMPL_VAR NAME="itemtagfield" -->">
	<input type="hidden" name="subfield" value="<!-- TMPL_VAR NAME="itemtagsubfield" -->">
	<input type="hidden" name="field_value" value="<!-- TMPL_VAR NAME="itemnum" -->">
	<input type="button" value="Save Changes" class="submit" onClick="Check(this.form)" accesskey="w">
	<!-- /TMPL_IF -->
	</form>
</div>
<script language="JavaScript" type="text/javascript">
function _(s) { return s } // dummy function for gettext
function active(numlayer)
{
	for (i=10; i < 11 ; i++ ) {
		ong = i+"XX";
			link = "link"+i;
		if (numlayer==i) {
			document.getElementById(ong).style.visibility="visible";
			document.getElementById(link).style.backgroundColor="#11AA11";
			document.getElementById(link).style.backgroundImage="url(<!-- TMPL_VAR NAME="themelang" -->/images/background-mem.gif)";
		} else {
			document.getElementById(ong).style.visibility="hidden";
			document.getElementById(link).style.backgroundColor="#FFFFFF";
			document.getElementById(link).style.backgroundImage="";
		}
	}
}
function Check(f) {
	var total_errors=0;
//	alert(f.field_value.length);
	for (i=0 ; i<f.field_value.length ; i++) {
//	alert (f.field_value[i].value);
		if (f.field_value[i].value.length==0 && f.mandatory[i].value==1) {
			document.getElementById("error"+i).style.backgroundColor="#FF0000";
			total_errors++;
		} else {
//			document.getElementById("error"+i).style.backgroundColor="#FFFFFF";
		}
	}
	var alertString2;
	if (total_errors==0) {
		document.f.submit();
	} else {
		alertString2  = _("Form not submitted because of the following problem(s)");
		alertString2 += "\n------------------------------------------------------------------------------------\n";
		alertString2 += "\n- "+ total_errors+_(" mandatory fields empty (see bold subfields)");
		alert(alertString2);
	}
}
function Dopop(link,i) {
	defaultvalue=document.forms[0].field_value[i].value;
	newin=window.open(link+"&result="+defaultvalue,"value builder",'width=500,height=400,toolbar=false,scrollbars=yes');
}
function confirm_deletion(bibid,itemnum) {
	var is_confirmed = confirm(_('Are you sure you want to delete this item?'));
	if (is_confirmed) {
	window.location = "additem.pl?op=delitem&bibid="+bibid+"&itemnum="+itemnum;
	}
}
</script>
<!-- TMPL_INCLUDE NAME="intranet-bottom.inc" -->